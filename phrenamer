#!/bin/sh

usage() {
	echo "usage: phrenamer [-h] [DIR]"
	exit 1
}

case "$1" in
	'-h') usage ;;
	*) dir="$1" ;;
esac

! [ "$dir" ] && dir="."

files=$(find "$dir" -regextype posix-extended -regex '.*\.(jpg|JPG|jpeg)')

digits=$(echo "$files" | wc -l | wc -c)
zeroes=$((digits-1)) # minus '\0'

IFS="
"
count=0
for fname in $files; do
	count=$((count+1))
	newname="$dir/$(printf %0${zeroes}d $count).jpg"
	! [ -f "$newname" ] && mv "$fname" "$newname"
done

